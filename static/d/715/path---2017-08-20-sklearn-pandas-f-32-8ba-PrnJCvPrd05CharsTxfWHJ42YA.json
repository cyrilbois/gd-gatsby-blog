{"data":{"site":{"siteMetadata":{"title":"Giacomo Debidda","author":"Giacomo Debidda"}},"markdownRemark":{"id":"3395a177-fa67-5479-9e60-499870f4c075 >>> MarkdownRemark","excerpt":"sklearn-pandas  is a small library that provides a bridge between  scikit-learn ’s machine learning methods and pandas Data Frames. In this…","html":"<p><a href=\"https://github.com/pandas-dev/sklearn-pandas\">sklearn-pandas</a> is a small library that provides a bridge between <a href=\"https://github.com/scikit-learn/scikit-learn\">scikit-learn</a>’s machine learning methods and pandas Data Frames.</p>\n<p>In this blog post I will show you a simple example on how to use sklearn-pandas in a classification problem. I will use the Titanic dataset from Kaggle. You can find training set e test set <a href=\"https://www.kaggle.com/c/titanic/data\">here</a>.</p>\n<h2>Imports</h2>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>os</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>pandas</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>as</span></span><span>&nbsp;</span><span>pd</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>preprocessing</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>LabelBinarizer</span><span>,&nbsp;</span><span>Imputer</span><span>,&nbsp;</span><span>LabelEncoder</span><span>,&nbsp;</span><span class=\"syntax--punctuation syntax--separator syntax--continuation syntax--line syntax--python\"><span>\\</span></span><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>FunctionTransformer</span><span>,&nbsp;</span><span>Binarizer</span><span>,&nbsp;</span><span>StandardScaler</span><span>,&nbsp;</span><span>MultiLabelBinarizer</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>pipeline</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>Pipeline</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>ensemble</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>RandomForestClassifier</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>model_selection</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>StratifiedKFold</span><span>,&nbsp;</span><span>cross_val_score</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>metrics</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>accuracy_score</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn_pandas</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>DataFrameMapper</span><span>,&nbsp;</span><span>CategoricalImputer</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>here</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>abspath</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>dirname</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--support syntax--variable syntax--magic syntax--python\"><span>__file__</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div></pre>\n<h2>Data</h2>\n<p>Kaggle provides separate files for training set e test set: <code class=\"language-text\">trains.csv</code> contains class labels (0 = dead; 1 = survived), while <code class=\"language-text\">test.csv</code> does not.</p>\n<p>If you want you can perform some basic EDA (Exploratory Data Analysis). Be careful of <a href=\"https://www.quora.com/Whats-data-leakage-in-data-science\">data leakege</a> though! Don’t use test data to carry on EDA, otherwise you will be tempted to select some features or perform some operations based on what you see on the test data. Here I will concatenate training set and test set just to see the total number of samples and the missing values of the entire dataset. I will “touch” the test set only at the end, for prediction.</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>data_directory</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>abspath</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>here</span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>data</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>titanic</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>train_csv</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>data_directory</span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>train.csv</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>test_csv</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>data_directory</span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>test.csv</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>df_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pd</span><span>.</span><span>read_csv</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>train_csv</span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>header</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>0</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>index_col</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>PassengerId</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>df_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pd</span><span>.</span><span>read_csv</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>test_csv</span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>header</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>0</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>index_col</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>PassengerId</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>df</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pd</span><span>.</span><span>concat</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>df_train</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>df_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>keys</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>train</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>test</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>---&nbsp;Info&nbsp;---</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>df</span><span>.</span><span>info</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>---&nbsp;Describe&nbsp;---</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>df</span><span>.</span><span>describe</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>---&nbsp;Features&nbsp;---</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--repeat syntax--python\"><span>for</span></span><span>&nbsp;</span><span>feature</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--logical syntax--python\"><span>in</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--support syntax--type syntax--python\"><span>set</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>df_train</span><span>.</span><span>columns</span><span>.</span><span>values</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>d</span><span>ifference</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--support syntax--type syntax--python\"><span>set</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Name</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>:</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span>feature</span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>df</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>feature</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>v</span><span>alue_counts</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>dropna</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--language syntax--python\"><span>False</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>-</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--arithmetic syntax--python\"><span>*</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>40</span></span><span>)</span></span></div></pre>\n<h2>Features</h2>\n<p>When working on a machine learning problem, feature engineering is manually <a href=\"https://www.quora.com/What-is-feature-engineering/answer/Tomasz-Malisiewicz?srid=tdBp\">designing what the input x’s should be</a>.</p>\n<p>With sklearn-pandas you can use the <code class=\"language-text\">DataFrameMapper</code> class to declare transformations and variable imputations.</p>\n<p><code class=\"language-text\">default=False</code> means that only the variables specified in the <code class=\"language-text\">DataFrameMapper</code> will be kept. All other variables will be discarded.</p>\n<p><code class=\"language-text\">None</code> means that no transformation will be applied to that variable.</p>\n<p><code class=\"language-text\">LabelBinarizer</code> converts a categorical variable into a <em>dummy variable</em> (aka <em>binary variable</em>). A dummy variable is either 1 or 0, whether a condition is met or not (in pandas categorical variables can be converted into dummy variables with the method <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html\">get_dummies</a>).</p>\n<p><code class=\"language-text\">Imputer</code> is a scikit-learn class that can perform NA imputation for quantitative variables, while <code class=\"language-text\">CategoricalImputer</code> is a sklearn-pandas class that works on categorical variables too. <a href=\"https://en.wikipedia.org/wiki/Imputation_(statistics)\">Missing value imputation</a> is a broad topic, and in other languages there are entire packages dedicated to it. For example, in R you can find <a href=\"https://www.r-bloggers.com/imputing-missing-data-with-r-mice-package/\">MICE</a> and <a href=\"https://github.com/IQSS/Amelia\">Amelia</a>.</p>\n<p>In a <code class=\"language-text\">DataFrameMapper</code> you can also provide a custom name for the transformed features – to be used instead of the automatically generated one – by specifying it as the third argument of the feature definition.</p>\n<p>The difference between specifying the column selector as <code class=\"language-text\">&#39;column&#39;</code> (as a simple string) and <code class=\"language-text\">[&#39;column&#39;]</code> (as a list with one element is the shape of the array that is passed to the transformer. In the first case, a one dimensional array will be passed, while in the second case it will be a 2-dimensional array with one column, i.e. a column vector.</p>\n<p><em>Example:</em> with a simple string <code class=\"language-text\">Imputer()</code> will discard <code class=\"language-text\">NaN</code> values for the column <code class=\"language-text\">Age</code>, and the fitting process will fail because of a mismatch of the size of this array and the other arrays in the <code class=\"language-text\">DataFrame</code>.</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>mapper</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>DataFrameMapper</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Pclass</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--constant syntax--language syntax--python\"><span>None</span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Sex</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>LabelBinarizer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Age</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Imputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>SibSp</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--constant syntax--language syntax--python\"><span>None</span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--dictionary syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--dictionary syntax--begin syntax--python\"><span>{</span></span><span class=\"syntax--meta syntax--structure syntax--dictionary syntax--key syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>alias</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--separator syntax--valuepair syntax--dictionary syntax--python\"><span>:</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--dictionary syntax--value syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Some&nbsp;variable</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--dictionary syntax--end syntax--python\"><span>}</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Ticket</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>LabelBinarizer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Fare</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Imputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Embarked</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>CategoricalImputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>MultiLabelBinarizer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>default</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--language syntax--python\"><span>False</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div></pre>\n<p>Once again, here is how to use <code class=\"language-text\">DataMapper</code>:</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>mapper</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>DataFrameMapper</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Age</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Imputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;OK</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Age</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Imputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;NO!</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div></pre>\n<h2>Pipeline</h2>\n<p>Now that the you defined the features you want to use, you can build a scikit-learn <code class=\"language-text\">Pipeline</code>. The first step of the Pipeline is the <code class=\"language-text\">mapper</code> you have just defined. The last step is a scikit-learn <code class=\"language-text\">Estimator</code> that will run the classification. In this case I chose a <code class=\"language-text\">RandomForestClassifier</code> with a basic configuration. Between these two steps you can define additional ones. For example, you might want to <a href=\"https://en.wikipedia.org/wiki/Standard_score\">z-normalize</a> your features with a <code class=\"language-text\">StandardScaler</code>.</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>pipeline</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Pipeline</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>feature_mapper</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span>mapper</span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>scaler</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>StandardScaler</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>classifier</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>RandomForestClassifier</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>n_estimators</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>50</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>random_state</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>seed</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div></pre>\n<h2>Cross validation</h2>\n<p>The pipeline is ready, so you can train your model. In order to provide several estimates of the model’s accuracy you can use cross validation. scikit-learn provides the convenient function <code class=\"language-text\">cross_val_score</code> to do that, but you can also do it manually. Keep in mind that we are not touching the test set here: <code class=\"language-text\">xx_train</code> and <code class=\"language-text\">xx_test</code> are both part of the entire training set. We just split the entire training set to train it on <code class=\"language-text\">xx_train</code> and predict on <code class=\"language-text\">xx_test</code>.</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>x_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>df_train</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>df_train</span><span>.</span><span>columns</span><span>.</span><span>drop</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Survived</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>y_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>df_train</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Survived</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;one&nbsp;way&nbsp;of&nbsp;computing&nbsp;cross-validated&nbsp;accuracy&nbsp;estimates</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>skf</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>StratifiedKFold</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>n_splits</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>3</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>shuffle</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--language syntax--python\"><span>True</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>random_state</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>seed</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>scores</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>cross_val_score</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>pipeline</span><span>,&nbsp;</span><span>x_train</span><span>,&nbsp;</span><span>y_train</span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>cv</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>skf</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Accuracy&nbsp;estimates:&nbsp;</span><span class=\"syntax--constant syntax--other syntax--placeholder syntax--python\"><span>{}</span></span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>f</span><span>ormat</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>scores</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;another&nbsp;way&nbsp;of&nbsp;computing&nbsp;cross-validated&nbsp;accuracy&nbsp;estimates</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--repeat syntax--python\"><span>for</span></span><span>&nbsp;</span><span>i_split</span><span>,&nbsp;</span><span>(</span><span>ii_train</span><span>,&nbsp;</span><span>ii_test</span><span>)</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--logical syntax--python\"><span>in</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--support syntax--function syntax--builtin syntax--python\"><span>enumerate</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>skf</span><span>.</span><span>split</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>X</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>x_train</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>y_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>:</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;x_train&nbsp;(independent&nbsp;variables,&nbsp;aka&nbsp;features)&nbsp;is&nbsp;a&nbsp;pandas&nbsp;DataFrame.</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;xx_train&nbsp;and&nbsp;xx_test&nbsp;are&nbsp;pandas&nbsp;dataframes</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>xx_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>x_train</span><span>.</span><span>iloc</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_train</span><span>,&nbsp;:</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>xx_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>x_train</span><span>.</span><span>iloc</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_test</span><span>,&nbsp;:</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;y_train&nbsp;(target&nbsp;variable)&nbsp;is&nbsp;a&nbsp;pandas&nbsp;Series.</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;yy_train&nbsp;and&nbsp;yy_test&nbsp;are&nbsp;numpy&nbsp;arrays</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>yy_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>y_train</span><span>.</span><span>values</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>yy_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>y_train</span><span>.</span><span>values</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>model</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pipeline</span><span>.</span><span>fit</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>X</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>xx_train</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>yy_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>predictions</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>model</span><span>.</span><span>predict</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>xx_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>score</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>accuracy_score</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y_true</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>yy_test</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y_pred</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>predictions</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Accuracy&nbsp;of&nbsp;split&nbsp;num&nbsp;</span><span class=\"syntax--constant syntax--other syntax--placeholder syntax--python\"><span>{}</span></span><span>:&nbsp;</span><span class=\"syntax--constant syntax--other syntax--placeholder syntax--python\"><span>{}</span></span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>f</span><span>ormat</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>i_split</span><span>,&nbsp;</span><span>score</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;final&nbsp;model&nbsp;(retrain&nbsp;it&nbsp;on&nbsp;the&nbsp;entire&nbsp;train&nbsp;set)</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>model</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pipeline</span><span>.</span><span>fit</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>X</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>x_train</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>y_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div></pre>\n<h2>Predict</h2>\n<p>Now that the model is trained we can finally predict data that we have never seen before (i.e. the test set).</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;In&nbsp;this&nbsp;problem&nbsp;df_test&nbsp;doesn&#39;t&nbsp;contain&nbsp;the&nbsp;target&nbsp;variable&nbsp;&#39;Survived&#39;</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>x_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span>df_test</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>predictions</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>model</span><span>.</span><span>predict</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>x_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Predictions&nbsp;(0&nbsp;=&nbsp;dead,&nbsp;1&nbsp;=&nbsp;survived)</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span>predictions</span><span>)</span></span></div></pre>\n<h2>The entire script</h2>\n<p>Here is the entire script:</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>os</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>pandas</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>as</span></span><span>&nbsp;</span><span>pd</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>preprocessing</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>LabelBinarizer</span><span>,&nbsp;</span><span>Imputer</span><span>,&nbsp;</span><span>LabelEncoder</span><span>,&nbsp;</span><span class=\"syntax--punctuation syntax--separator syntax--continuation syntax--line syntax--python\"><span>\\</span></span><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>FunctionTransformer</span><span>,&nbsp;</span><span>Binarizer</span><span>,&nbsp;</span><span>StandardScaler</span><span>,&nbsp;</span><span>MultiLabelBinarizer</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>pipeline</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>Pipeline</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>ensemble</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>RandomForestClassifier</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>model_selection</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>StratifiedKFold</span><span>,&nbsp;</span><span>cross_val_score</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn</span><span>.</span><span>metrics</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>accuracy_score</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--import syntax--from syntax--python\"><span>from</span></span><span>&nbsp;</span><span>sklearn_pandas</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--import syntax--python\"><span>import</span></span><span>&nbsp;</span><span>DataFrameMapper</span><span>,&nbsp;</span><span>CategoricalImputer</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>here</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>abspath</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>dirname</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--support syntax--variable syntax--magic syntax--python\"><span>__file__</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function syntax--python\"><span class=\"syntax--storage syntax--type syntax--function syntax--python\"><span>def</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--function syntax--python\"><span>main</span></span><span class=\"syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function syntax--parameters syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>seed</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>42</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--python\"><span>)</span></span><span class=\"syntax--punctuation syntax--section syntax--function syntax--begin syntax--python\"><span>:</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>data_directory</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>abspath</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>here</span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>data</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>titanic</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>train_csv</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>data_directory</span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>train.csv</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>test_csv</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>os</span><span>.</span><span>path</span><span>.</span><span>join</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>data_directory</span><span>,&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>test.csv</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>df_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pd</span><span>.</span><span>read_csv</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>train_csv</span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>header</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>0</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>index_col</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>PassengerId</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>df_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pd</span><span>.</span><span>read_csv</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>test_csv</span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>header</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>0</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>index_col</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>PassengerId</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>df</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pd</span><span>.</span><span>concat</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>df_train</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>df_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>keys</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>train</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>test</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>---&nbsp;Info&nbsp;---</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>df</span><span>.</span><span>info</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>---&nbsp;Describe&nbsp;---</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>df</span><span>.</span><span>describe</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>---&nbsp;Features&nbsp;---</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--repeat syntax--python\"><span>for</span></span><span>&nbsp;</span><span>feature</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--logical syntax--python\"><span>in</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--support syntax--type syntax--python\"><span>set</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>df_train</span><span>.</span><span>columns</span><span>.</span><span>values</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>d</span><span>ifference</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--support syntax--type syntax--python\"><span>set</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Name</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>:</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span>feature</span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>df</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>feature</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>v</span><span>alue_counts</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>dropna</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--language syntax--python\"><span>False</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>-</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--arithmetic syntax--python\"><span>*</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>40</span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>mapper</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>DataFrameMapper</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Pclass</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--constant syntax--language syntax--python\"><span>None</span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Sex</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>LabelBinarizer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Age</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Imputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>SibSp</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--constant syntax--language syntax--python\"><span>None</span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--dictionary syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--dictionary syntax--begin syntax--python\"><span>{</span></span><span class=\"syntax--meta syntax--structure syntax--dictionary syntax--key syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>alias</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--separator syntax--valuepair syntax--dictionary syntax--python\"><span>:</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--dictionary syntax--value syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Some&nbsp;variable</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--dictionary syntax--end syntax--python\"><span>}</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Ticket</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>LabelBinarizer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Fare</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Imputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Embarked</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>CategoricalImputer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>MultiLabelBinarizer</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>default</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--language syntax--python\"><span>False</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>pipeline</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>Pipeline</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>feature_mapper</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span>mapper</span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>scaler</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>StandardScaler</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span><span class=\"syntax--punctuation syntax--separator syntax--list syntax--python\"><span>,</span></span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>classifier</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>,&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>RandomForestClassifier</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>n_estimators</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>50</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>random_state</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>seed</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>x_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>df_train</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>df_train</span><span>.</span><span>columns</span><span>.</span><span>drop</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--structure syntax--list syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--list syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--structure syntax--list syntax--item syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Survived</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--list syntax--end syntax--python\"><span>]</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>y_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>df_train</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Survived</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;one&nbsp;way&nbsp;of&nbsp;computing&nbsp;cross-validated&nbsp;accuracy&nbsp;estimates</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>skf</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>StratifiedKFold</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>n_splits</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--numeric syntax--integer syntax--decimal syntax--python\"><span>3</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>shuffle</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span class=\"syntax--constant syntax--language syntax--python\"><span>True</span></span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>random_state</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>seed</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>scores</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>cross_val_score</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>pipeline</span><span>,&nbsp;</span><span>x_train</span><span>,&nbsp;</span><span>y_train</span><span>,&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>cv</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>skf</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Accuracy&nbsp;estimates:&nbsp;</span><span class=\"syntax--constant syntax--other syntax--placeholder syntax--python\"><span>{}</span></span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>f</span><span>ormat</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>scores</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;another&nbsp;way&nbsp;of&nbsp;computing&nbsp;cross-validated&nbsp;accuracy&nbsp;estimates</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--repeat syntax--python\"><span>for</span></span><span>&nbsp;</span><span>i_split</span><span>,&nbsp;</span><span>(</span><span>ii_train</span><span>,&nbsp;</span><span>ii_test</span><span>)</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--logical syntax--python\"><span>in</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span class=\"syntax--support syntax--function syntax--builtin syntax--python\"><span>enumerate</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--meta syntax--function-call syntax--python\"><span>skf</span><span>.</span><span>split</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>X</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>x_train</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>y_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>:</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;x_train&nbsp;(independent&nbsp;variables,&nbsp;aka&nbsp;features)&nbsp;is&nbsp;a&nbsp;pandas&nbsp;DataFrame.</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;xx_train&nbsp;and&nbsp;xx_test&nbsp;are&nbsp;pandas&nbsp;dataframes</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>xx_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>x_train</span><span>.</span><span>iloc</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_train</span><span>,&nbsp;:</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>xx_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>x_train</span><span>.</span><span>iloc</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_test</span><span>,&nbsp;:</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;y_train&nbsp;(target&nbsp;variable)&nbsp;is&nbsp;a&nbsp;pandas&nbsp;Series.</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;yy_train&nbsp;and&nbsp;yy_test&nbsp;are&nbsp;numpy&nbsp;arrays</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>yy_train</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>y_train</span><span>.</span><span>values</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>yy_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--item-access syntax--python\"><span>y_train</span><span>.</span><span>values</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>[</span></span><span class=\"syntax--meta syntax--item-access syntax--arguments syntax--python\"><span>ii_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>]</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>model</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pipeline</span><span>.</span><span>fit</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>X</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>xx_train</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>yy_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>predictions</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>model</span><span>.</span><span>predict</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>xx_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>score</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>accuracy_score</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y_true</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>yy_test</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y_pred</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>predictions</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Accuracy&nbsp;of&nbsp;split&nbsp;num&nbsp;</span><span class=\"syntax--constant syntax--other syntax--placeholder syntax--python\"><span>{}</span></span><span>:&nbsp;</span><span class=\"syntax--constant syntax--other syntax--placeholder syntax--python\"><span>{}</span></span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>.</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>f</span><span>ormat</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>i_split</span><span>,&nbsp;</span><span>score</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;final&nbsp;model&nbsp;(retrain&nbsp;it&nbsp;on&nbsp;the&nbsp;entire&nbsp;train&nbsp;set)</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>model</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>pipeline</span><span>.</span><span>fit</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>X</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>x_train</span><span class=\"syntax--punctuation syntax--separator syntax--parameters syntax--python\"><span>,</span></span><span>&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--function syntax--python\"><span>y</span></span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>y_train</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--number-sign syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--python\"><span>#</span></span><span>&nbsp;In&nbsp;this&nbsp;problem&nbsp;df_test&nbsp;doesn&#39;t&nbsp;contain&nbsp;the&nbsp;target&nbsp;variable&nbsp;&#39;Survived&#39;</span><span>&nbsp;</span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>x_test</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span>df_test</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>predictions</span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--python\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>model</span><span>.</span><span>predict</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--meta syntax--function-call syntax--arguments syntax--python\"><span>x_test</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>Predictions&nbsp;(0&nbsp;=&nbsp;dead,&nbsp;1&nbsp;=&nbsp;survived)</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--other syntax--python\"><span>print</span></span><span>(</span><span>predictions</span><span>)</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span class=\"syntax--keyword syntax--control syntax--conditional syntax--python\"><span>if</span></span><span>&nbsp;</span><span class=\"syntax--support syntax--variable syntax--magic syntax--python\"><span>__name__</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--comparison syntax--python\"><span>==</span></span><span>&nbsp;</span><span class=\"syntax--string syntax--quoted syntax--single syntax--single-line syntax--python\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--python\"><span>&#39;</span></span><span>__main__</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--python\"><span>&#39;</span></span></span><span>:</span></span></div><div class=\"line\"><span class=\"syntax--source syntax--python\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--function-call syntax--python\"><span>main</span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--begin syntax--python\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--arguments syntax--end syntax--python\"><span>)</span></span></span></span></div></pre>\n<p>If you run it, you should get these results with <code class=\"language-text\">seed=42</code>:</p>\n<pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>Accuracy&nbsp;estimates:&nbsp;[&nbsp;0.7979798&nbsp;&nbsp;&nbsp;0.83501684&nbsp;&nbsp;0.81144781]</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>Accuracy&nbsp;of&nbsp;split&nbsp;num&nbsp;0:&nbsp;0.797979797979798</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>Accuracy&nbsp;of&nbsp;split&nbsp;num&nbsp;1:&nbsp;0.835016835016835</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>Accuracy&nbsp;of&nbsp;split&nbsp;num&nbsp;2:&nbsp;0.8114478114478114</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>Predictions&nbsp;(0&nbsp;=&nbsp;dead,&nbsp;1&nbsp;=&nbsp;survived)</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>[0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;1</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;1&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0&nbsp;0</span></span></div><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>&nbsp;0&nbsp;1&nbsp;1&nbsp;1&nbsp;1&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;0]</span></span></div></pre>","frontmatter":{"title":"sklearn-pandas","date":"August 20, 2017"}}},"pageContext":{"slug":"/2017-08-20-sklearn-pandas/","previous":{"fields":{"slug":"/2017-08-07-quickstart-python-projects-with-invoke/"},"frontmatter":{"title":"Quickstart Python projects with Invoke"}},"next":{"fields":{"slug":"/2017-08-29-a-few-timeless-lessons-from-peopleware/"},"frontmatter":{"title":"A few timeless lessons from Peopleware"}}}}